<!DOCTYPE html>
<html>

<head>
    <link rel="manifest" href="/manifest.json">
    <!-- <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" /> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0;">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="default_styles.css">
    <link rel="stylesheet" type="text/css" href="sidebar.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css">
    <link href='https://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet'>
    <link rel="stylesheet" type="text/css" href="navigationbar.css">
    <link rel="stylesheet" type="text/css" href="profilePage.css">
    <link rel="stylesheet" type="text/css" href="eventCard.css">
    <meta charset='utf-8'>
    <title>Branja - Event Page</title>
</head>
<style type="text/css">
.sidenav a {
    text-decoration: none;
}
</style>

<body>
    <div class="dark-overlay" id="darkSideNav" onclick="closeNav()"></div>
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <div id="description">
            <!--             <p>This is <strong>branja</strong>.</p>
            <p> Plan them here with friends, nice and simple. </p> -->
            <h2> menu </h2>
            </br>
            <a href="homepage.html">homepage</a></br>
            <a href="profilePage.html">profile</a></br>
            <a href="#">search</a></br>
            <!-- <a href="#">settings</a></br> -->
            <!-- <a href="#">about</a></br> -->
            </br>
            <p><a href="#">logout</a></p>
        </div>
    </div>
    <div id="main">
        <nav class="navbar fixed-top navbar-dark bg-light main-nav d-flex">
            <div id="menu-btn" onclick="openNav()">&#9776;</div>
            <ul class="nav navbar-nav mx-auto">
                <li class="nav-item">
                    <a href="index.html" id="no-underline">
                        <div id="logo">
                            <div><img src="images/house.png" id="branjaLogoHouse"></div>
                            <div id="branjaLogoText">branja</div>
                        </div>
                    </a>
                </li>
            </ul>
        </nav>
        <!-- end of navigation bar -->
        <!-- start of user's profile -->
        <div class="body">
            <div class="container">
                <div class="profileBody">
                    <div class="profileTop">
                        <div class="profileTopSection">
                            <img src="https://imgc.allpostersimages.com/img/posters/the-godfather-part-ii-robert-de-niro-1974_u-L-Q12P8AZ0.jpg?src=gp&w=300&h=375" class="profileImage">
                        </div>
                        <div class="profileTopSection">
                            <span class="username">intremelo</span>
                            <br>
                            <span class="fullName">Michael Rubin</span>
                            <br>
                            <button class="btn btn-success" id="profileButton" onmouseover="updateButtonText();" onmouseleave="revert();">
                                <span id="friends" style="display:inline">‚úî friends </span>
                                <span id="removeFriend" style="display:none">&times; remove friend</span>
                                <span id="requestPending" style="display:none">&times; request pending</span>
                                <span id="addFriend" style="display:none">add friend</span>
                                <span id="editProfile" style="display: none">edit profile</span>
                            </button>
                        </div>
                    </div>
                    <hr>
                    <div class="profileDetails">
                        üìçLos Angeles
                        <br> üîó<a href="https://www.google.com" target="_blank">google.com</a>
                        <br> üì£Hi my name is Mike!
                    </div>
                    <hr>
                    <div class="profileNumbers">
                        <div class="numberBox"><span class="number">123</span> events</div>
                        <div class="numberBox"><span class="number">4</span> branjas</div>
                        <div class="numberBox"><span class="number">89</span> friends</div>
                    </div>
                    <hr>
                    <div class="upcomingEvents">
                        <span class="upcomingEventsHeader">intremelo's upcoming events</span>
                        <div id="eventListBottom">
                        </div>
                    </div>
                </div>
            </div>
        </div>
</body>
<script>
// =============== DUMMY OBJECTS FOR TESTING ===============
var user = {
    username: "intremelo",
    fullName: "Michael Rubin",
    currentCity: "Los Angeles",
    url: "google.com",
    bio: "Hey I'm Mike!",
    friendCount: "123",
    eventCount: "14"
};

var friends = [{
        username: "bennyruby",
        fullName: "Benjamin Rubin",
        userId: "12"
    },
    {
        username: "helen",
        fullName: "Helen Rubin",
        userId: "14"
    },
    {
        username: "joey",
        fullName: "Joey Rubin",
        userId: "15"
    }

];

var attendedEvents = [{
        eventId: "1",
        eventName: "Helen's Bday Party"
    },
    {
        eventId: "2",
        eventName: "Michael's Bday Party"
    }
];

 //event array
        var events = [{
                eventId: "1",
                eventName: "Helen's Bday Party",
                eventType: "private",
                eventAddress: "702 W 30th Street, CA 90007",
                eventDate: "March 19th at 7:00 PM",
                eventAttendees: "100",
                eventImage: "https://scontent-lax3-1.xx.fbcdn.net/v/t1.0-9/30727751_10213997511185563_3766213558656827392_o.jpg?_nc_cat=0&oh=994d2510d4e73c87b0949f3a6466a196&oe=5B67CDEC",
                latitude: "34.025721",
                longitude: "-118.280009"
            },
            {
                eventId: "2",
                eventName: "Michael's Bday Party",
                eventType: "open",
                eventAddress: "702 W 34th Street, CA 90007",
                eventDate: "March 29th at 7:00 PM",
                eventAttendees: "200",
                eventImage: "https://vegaspartyvip.com/wp-content/uploads/2013/02/rehab_party1.jpeg",
                latitude: "34.041266",
                longitude: "-118.269530"
            }
        ];

 for (var i = 0; i < events.length; i++) {

            //Step 1: add the event's marker to the map
            var eventLoc = { lat: parseFloat(events[i].latitude), lng: parseFloat(events[i].longitude) };

            //Step 2: add the event to the eventList
            createEventCard(events[i], (i), "eventList", "profilePage");

        }



        //This function generates an Event Card, whether in the eventList or as an info window on the map
        function createEventCard(event, eventNumber, destination, type) {
            //get event number
            console.log("event number is: " + eventNumber);
            //get the text associated with that number
            console.log(event);

            //create the event's image
            var eventSectionImage = document.createElement("div");
            eventSectionImage.classList.add("eventSection");

            var eventImg = document.createElement("img");
            eventImg.classList.add("eventListItemImage");
            eventImg.src = event.eventImage;

            eventSectionImage.appendChild(eventImg);

            //create the event's description description
            var eventSectionDes = document.createElement("div");
            eventSectionDes.classList.add("eventDescription");
            eventSectionDes.innerHTML = "<strong>" + event.eventName.toUpperCase() + "</strong> <p>" + event.eventAddress + "<br>" + event.eventDate + "<br>" + event.eventAttendees + " people going" + "</p>";


            //create the event's marker
            var eventSectionMarker = document.createElement("div");
            eventSectionMarker.classList.add("eventSectionMarker");

            var markerImg = document.createElement("img");
            markerImg.classList.add("eventListMarker");
            var imgsrc = "images/eventListMarkers/eventListMarker_";
            if (event.eventType === "private") {
                imgsrc += "private.png";
            } else if (event.eventType === "open") {
                imgsrc += "open.png"
            }

            markerImg.src = imgsrc;

            //create the event list marker

            //start off with the number
            var eventListMarkerNumber = document.createElement("div");
            eventListMarkerNumber.classList.add("eventListMarkerNumber");
            eventListMarkerNumber.innerHTML = (eventNumber + 1);

            //create event type
            var eventType = document.createElement("span");
            eventType.innerHTML = event.eventType;

            eventSectionMarker.appendChild(markerImg);
            //this needs to be adjusted for future events
            if(type != "profilePage"){
                eventSectionMarker.appendChild(eventListMarkerNumber);    
            }
            eventSectionMarker.appendChild(eventType);


            var linkWrapper = document.createElement("a");
            linkWrapper.href = "eventPage.html?eventID=" + event.eventID;


            //append all three sections to the element
            var eventListItem = document.createElement("div");
            eventListItem.classList.add("eventListItem");

            eventListItem.appendChild(eventSectionImage);
            eventListItem.appendChild(eventSectionDes);
            eventListItem.appendChild(eventSectionMarker);


            //add event listener

            eventListItem.addEventListener('click', function(){
              var url = "eventPage.html?eventId=" + event.eventId;
              window.location = url;
            });

            if (destination === "map") {
                document.getElementById("infoWindow").appendChild(eventListItem);
            } else if (destination === "eventList") {
                document.getElementById("eventListBottom").appendChild(eventListItem);
            }
        }




//========================== Profile Button Code ==========================
document.getElementById("profileButton").onclick = function() {
    if (document.getElementById("friends").style.display === "inline" ||
        document.getElementById("removeFriend").style.display === "inline"){

        var confirmDelete = confirm("You are sure you want to remove " + user.fullName + " from your friend list?");
        if (confirmDelete == true) {
            document.getElementById("friends").style.display = "none";
            document.getElementById("removeFriend").style.display = "none";
            document.getElementById("addFriend").style.display = "inline";
            document.getElementById("profileButton").classList.remove("btn-success");
            document.getElementById("profileButton").classList.remove("btn-warning");
            document.getElementById("profileButton").classList.add("btn-primary");
        }
    }
     else if (document.getElementById("addFriend").style.display === "inline") {
        document.getElementById("addFriend").style.display = "none";
        document.getElementById("requestPending").style.display = "inline";
        document.getElementById("profileButton").classList.remove("btn-primary");
        document.getElementById("profileButton").classList.add("btn-secondary");
    }
    else if (document.getElementById("requestPending").style.display === "inline") {
        document.getElementById("requestPending").style.display = "none";
         document.getElementById("addFriend").style.display = "inline";   
         document.getElementById("profileButton").classList.remove("btn-secondary");
        document.getElementById("profileButton").classList.add("btn-primary");
    }
    else if (document.getElementById("editProfile").style.display === "inline") {
        var url = "editProfile.html";
        window.location = url;
    }
}   


function updateButtonText(){
    if (document.getElementById("friends").style.display === "inline"){
        document.getElementById("friends").style.display = "none";
        document.getElementById("removeFriend").style.display = "inline";
        document.getElementById("profileButton").classList.remove("btn-success");
        document.getElementById("profileButton").classList.add("btn-warning");
    }
}

function revert() {
    if(document.getElementById("removeFriend").style.display === "inline"){
        document.getElementById("removeFriend").style.display = "none";
        document.getElementById("friends").style.display = "inline";
        document.getElementById("profileButton").classList.remove("btn-warning");
        document.getElementById("profileButton").classList.add("btn-success");
    }
}


</script>
<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script>
function openNav() {
    console.log(document.getElementById("darkSideNav").style.visibility);
    document.getElementById("mySidenav").style.width = "250px";
    document.getElementById("darkSideNav").style.visibility = "visible";
    document.getElementById("darkSideNav").style.opacity = "0.5";
}

function closeNav() {
    console.log(document.getElementById("darkSideNav").style.visibility);
    document.getElementById("mySidenav").style.width = "0";
    document.getElementById("darkSideNav").style.opacity = "0";
    document.getElementById("darkSideNav").style.visibility = "hidden";
}
</script>

</html>